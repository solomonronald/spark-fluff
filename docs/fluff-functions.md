# Fluff Functions

Fluff Functions is how _Spark Fluff_ converts the i.i.d's provided by [Spark MLlib's RandomRDDs](https://spark.apache.org/docs/3.0.0-preview/api/scala/org/apache/spark/mllib/random/RandomRDDs$.html) into required random data.

Following are the functions available in _Spark Fluff_

- [Range](#Range)
- [List](#List)
- [UUID](#UUID)
- [Constant](#Constant)
- [Date](#Date)
- [Boolean](#Boolean)

## Range

Pick a decimal value from range between _min_ and _max_ values. The _min_ value is included, but the _max_ is __not__. [min, max)

A _precision_ parameter can also be provided to define the decimal precision of generated values.

#### Range Usage

Add the following to your `functionExpr` column.

``` text
range(<min>|<max>|<precision>)
```

#### Range Examples

Following are added to your `functionExpr` column.

1. Pick a number between 1 and 10. 1 and 10 included. [1, 10]

    ``` text
    range(1|11|0)
    ```

1. Pick a 6 decimal precision number which is greater than or equal to 0.0 but less than 1.0. [0.0, 1.0)

    ``` text
    range(0|1|6)
    ```

#### Null Percentage for Range

Apart from the basic usage, you can add the null percentage to `range` function as follows:  
`range(<min>|<max>|<precision>)[<null percentage>%]`

Example to set null percentage of range to 10%:  
`range(1|11|0)[10%]`

#### Implementation Class for Range

[RangeFluff.scala](../src/main/scala/com/github/solomonronald/spark/fluff/types/RangeFluff.scala)

## List

Pick an item from a pipe `|` delimited list of values. 

#### List Usage

Add the following to your `functionExpr` column.

``` text
list(<value 1>|<value 2>|<value 3>|...)
```

#### List Examples

Following are added to your `functionExpr` column.

1. Pick a vowel.

    ``` text
    list(a|e|i|o|u)
    ```

1. Pick a fruit from fruit list

    ``` text
    list(Apple|Orange|Banana|Mango)
    ```

#### Null Percentage for List

Apart from the basic usage, you can add the null percentage to `list` function as follows:  
`list(<value 1>|<value 2>|<value 3>|...)[<null percentage>%]`

Example to set null percentage of list to 10%:  
`list(a|e|i|o|u)[10%]`

#### Implementation Class for List

[ListFluff.scala](../src/main/scala/com/github/solomonronald/spark/fluff/types/ListFluff.scala)

## UUID

Generates random UUID values. No other parameter is needed to generate UUID.

__Note:__ The UUID values generated by this function is independent of the seed value (if seed value is provided).

#### UUID Usage

Add the following to your `functionExpr` column.

``` text
uuid()
```

#### Null Percentage for UUID

Apart from the basic usage, you can add the null percentage to `uuid` function as follows:  
`uuid()[<null percentage>%]`

Example to set null percentage of uuid to 10%:  
`uuid()[10%]`

#### Implementation Class for UUID

[UuidFluff.scala](../src/main/scala/com/github/solomonronald/spark/fluff/types/UuidFluff.scala)

## Constant

Fill a column with just a constant value.

#### Constant Usage

Add the following to your `functionExpr` column.

``` text
const(<constant value>)
```

#### Constant Examples

Following are added to your `functionExpr` column.

1. Fill the column with string `"foo"`

    ``` text
    const(foo)
    ```

1. Fill the column with string `"blablabla"`

    ``` text
    const(blablabla)
    ```

#### Null Percentage for Constant

Apart from the basic usage, you can add the null percentage to `const` function as follows:  
`const(<constant value>)[<null percentage>%]`

Example to set null percentage of range to 10%:  
`const(foo)[10%]`

#### Implementation Class for Constant

[ConstFluff.scala](../src/main/scala/com/github/solomonronald/spark/fluff/types/ConstFluff.scala)

## Date

Pick a date time value from range between _min_ and _max_ date values. The _min_ value is included, but the _max_ is __not__. [min, max)

A _format_ parameter is needed to define date format of generated and input values. The format should be a valid [Java SimpleDateFormat](https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html). 

#### Date Usage

Add the following to your `functionExpr` column.

``` text
date(<start date>|<end date>|<date format>)
```

#### Date Examples

Following are added to your `functionExpr` column.

1. Pick a date time between 2000-01-01 00:00 and 2030-12-31 23:59 in `yyyy-MM-dd HH:mm` format. 

    ``` text
    date(2000-01-01 00:00 | 2030-12-31 23:59 | yyyy-MM-dd HH:mm)
    ```

1. Pick a random date from year 2021 in `yyyy-MM-dd` format.

    ``` text
    date(2021-01-01 | 2021-12-31 | yyyy-MM-dd)
    ```

#### Null Percentage for Date

Apart from the basic usage, you can add the null percentage to `date` function as follows:  
`date(<start date>|<end date>|<date format>)[<null percentage>%]`

Example to set null percentage of date to 10%:  
`date(2021-01-01 | 2021-12-31 | yyyy-MM-dd)[10%]`

#### Implementation Class for Date

[DateFluff.scala](../src/main/scala/com/github/solomonronald/spark/fluff/types/DateFluff.scala)

## Boolean

Fill a column with `true` or `false` values. No other parameter is needed to generate boolean.

#### Boolean Usage

Add the following to your `functionExpr` column.

``` text
bool()
```

#### Null Percentage for Boolean

Apart from the basic usage, you can add the null percentage to `bool` function as follows:  
`bool()[<null percentage>%]`

Example to set null percentage of boolean to 10%:  
`bool()[10%]`

#### Implementation Class for Boolean

[BoolFluff.scala](../src/main/scala/com/github/solomonronald/spark/fluff/types/BooleanFluff.scala)
